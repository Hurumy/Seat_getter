
![table](/canvas.jpg?raw=true "回路図")

![table](/IMG_20230820_113523.jpg?raw=true "プリント例")

プルリク大歓迎大感謝<br>
何かあったら 聞いてください<br>
<br><br>

# 説明書

<br>

## 使い方
<br>

1. ArduinoIDEにUSB-UARTブリッジのドライバ、ボードマネージャ、依存ライブラリを全てインストールし、ESP32にプログラムを書き込む
2. シリアル通信でコアのデバッグ情報やら温度やらを見ることができます。
3. 書き込み終わったら一旦パソコンからケーブルを抜き、ACアダプタを利用して電源タップから直に給電するようにする（重要。理由は後述）
4. 猫プリンターの電源ボタンを長押しします。起動すると、親機を探して青いランプが点滅します
5. 接続が確立すると青いランプが点滅→点灯に変化します。点灯している間は接続ができています。接続が確立すると、ESP32に現在書き込まれているプログラムの設定の詳細を吐き出して一旦停止します。
6. ボタンを押すと、プログラムで指定した枚数の席くじが印刷されます。安定動作のため必要以上にdelayを仕込んでいます。連打しても無視されるので大丈夫です。
7. くじに混ぜた全ての席を吐き出し終わると、接続を切ります。猫プリンターのランプは点滅に戻ります。ESP32本体表面のボタンを押すと、プログラムをリセットしてもう一度最初から実行し直すことができます。

<br><br>

## 注意点

<br>

### 途中でリセットをかけてしまった席くじの情報を取り戻したい；；

途中でリセットされてしまった場合でも、プログラムのRandomのSeedの部分を書き換えてもらえれば再現できます（当然）。<br>
Seedの実際の値は最初に吐き出す設定の紙に記載されています。非常事態にどうぞ。<br>

<br><br>

### 電源供給について

ノートパソコンからの電源供給は不安定です。無線接続をやるにあたってESP32は結構デカい電力(←日常語ではなく本当に電力、W)を消費するようです。<br>
ノートパソコンからのUSB経由での給電では連続で働かせるにあたっては不安です。<br>
気休めですがUSB給電よりはマシなので、デバッグ・書き込み時以外はなるべくACアダプタを使うようにしてください。<br>
データシート上の動作保証電圧は3.0V~3.6Vです。<br>

<br>

その他のESP32についての詳細はデータシートを参照してください。ESP32-DevkitC-32Eです。<br>
https://www.espressif.com/en/products/devkits/esp32-devkitc

<br><br>

### 用紙交換について

幅57mm、外径25mmくらいまでの感熱用紙ならなんでも使えそうです。適当にそこらで買って補充できます。<br>
猫プリンターにはさす軸がないので内径は不問です。勘で用紙の端だけ食わせておけば大丈夫そうです<br>

<br><br>

### 新しい猫プリンターを買ったんだけど接続できないよ〜

1. その猫プリンターのデバイス名を突き止めます。 猫プリンターの電源ボタンを二連打すると、MACアドレスとデバイス名を吐くはずです。
2. これを参考に、CatGFXライブラリのクラスの中にある、スキャンするデバイス名のリストにそのデバイス名を追加します(https://github.com/TheNitek/CatGFX/pull/5)
3. 検索できるはずです

<br><br>

<br><br>
